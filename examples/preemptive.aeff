operation stop : unit
operation go : unit

let rec preempt () =
  promise (stop _ |->
    promise (go _ |->
      return <<()>>
    ) as p in
    await p until <<y>> in
    preempt ()
  ) as p in
  return p

run
  preempt (); 1 + 1 + 1 + 1 + 1
